{"ast":null,"code":"import { acquireToken } from \"./auth\";\n\n// src/utils/graph.js\n// ...\nconst toUTC = d => new Date(d).toISOString();\nconst toGraphEvent = reservation => {\n  var _reservation$room;\n  return {\n    subject: reservation.title,\n    body: {\n      contentType: \"HTML\",\n      content: reservation.description || \"\"\n    },\n    start: {\n      dateTime: toUTC(reservation.startTime),\n      timeZone: \"UTC\"\n    },\n    end: {\n      dateTime: toUTC(reservation.endTime),\n      timeZone: \"UTC\"\n    },\n    // Ubicación visible en Outlook\n    location: {\n      displayName: ((_reservation$room = reservation.room) === null || _reservation$room === void 0 ? void 0 : _reservation$room.nombre) || \"Sala\"\n    },\n    // Teams\n    isOnlineMeeting: true,\n    onlineMeetingProvider: \"teamsForBusiness\",\n    // Recordatorio (minutos)\n    isReminderOn: true,\n    reminderMinutesBeforeStart: 15,\n    // Categoría (créala una vez en Outlook si quieres un color)\n    categories: [\"Salas FYCO\"],\n    // Attendees opcionales (ver punto 2)\n    attendees: (reservation.attendees || []).map(email => ({\n      emailAddress: {\n        address: email\n      },\n      type: \"required\"\n    }))\n  };\n};\nexport const graphCreateEvent = async reservation => graphFetch(`/me/events`, {\n  method: \"POST\",\n  body: JSON.stringify(toGraphEvent(reservation))\n});\nexport const graphUpdateEvent = async (eventId, reservation) => graphFetch(`/me/events/${eventId}`, {\n  method: \"PATCH\",\n  body: JSON.stringify(toGraphEvent(reservation))\n});","map":{"version":3,"names":["acquireToken","toUTC","d","Date","toISOString","toGraphEvent","reservation","_reservation$room","subject","title","body","contentType","content","description","start","dateTime","startTime","timeZone","end","endTime","location","displayName","room","nombre","isOnlineMeeting","onlineMeetingProvider","isReminderOn","reminderMinutesBeforeStart","categories","attendees","map","email","emailAddress","address","type","graphCreateEvent","graphFetch","method","JSON","stringify","graphUpdateEvent","eventId"],"sources":["/Users/mairaquintero/Desktop/project-salas/src/utils/graph.js"],"sourcesContent":["import { acquireToken } from \"./auth\";\n\n// src/utils/graph.js\n// ...\nconst toUTC = (d) => new Date(d).toISOString();\n\nconst toGraphEvent = (reservation) => ({\n  subject: reservation.title,\n  body: { contentType: \"HTML\", content: reservation.description || \"\" },\n  start: { dateTime: toUTC(reservation.startTime), timeZone: \"UTC\" },\n  end:   { dateTime: toUTC(reservation.endTime),   timeZone: \"UTC\" },\n\n  // Ubicación visible en Outlook\n  location: { displayName: reservation.room?.nombre || \"Sala\" },\n\n  // Teams\n  isOnlineMeeting: true,\n  onlineMeetingProvider: \"teamsForBusiness\",\n\n  // Recordatorio (minutos)\n  isReminderOn: true,\n  reminderMinutesBeforeStart: 15,\n\n  // Categoría (créala una vez en Outlook si quieres un color)\n  categories: [\"Salas FYCO\"],\n\n  // Attendees opcionales (ver punto 2)\n  attendees: (reservation.attendees || []).map(email => ({\n    emailAddress: { address: email },\n    type: \"required\",\n  })),\n});\n\nexport const graphCreateEvent = async (reservation) =>\n  graphFetch(`/me/events`, {\n    method: \"POST\",\n    body: JSON.stringify(toGraphEvent(reservation)),\n  });\n\nexport const graphUpdateEvent = async (eventId, reservation) =>\n  graphFetch(`/me/events/${eventId}`, {\n    method: \"PATCH\",\n    body: JSON.stringify(toGraphEvent(reservation)),\n  });\n"],"mappings":"AAAA,SAASA,YAAY,QAAQ,QAAQ;;AAErC;AACA;AACA,MAAMC,KAAK,GAAIC,CAAC,IAAK,IAAIC,IAAI,CAACD,CAAC,CAAC,CAACE,WAAW,CAAC,CAAC;AAE9C,MAAMC,YAAY,GAAIC,WAAW;EAAA,IAAAC,iBAAA;EAAA,OAAM;IACrCC,OAAO,EAAEF,WAAW,CAACG,KAAK;IAC1BC,IAAI,EAAE;MAAEC,WAAW,EAAE,MAAM;MAAEC,OAAO,EAAEN,WAAW,CAACO,WAAW,IAAI;IAAG,CAAC;IACrEC,KAAK,EAAE;MAAEC,QAAQ,EAAEd,KAAK,CAACK,WAAW,CAACU,SAAS,CAAC;MAAEC,QAAQ,EAAE;IAAM,CAAC;IAClEC,GAAG,EAAI;MAAEH,QAAQ,EAAEd,KAAK,CAACK,WAAW,CAACa,OAAO,CAAC;MAAIF,QAAQ,EAAE;IAAM,CAAC;IAElE;IACAG,QAAQ,EAAE;MAAEC,WAAW,EAAE,EAAAd,iBAAA,GAAAD,WAAW,CAACgB,IAAI,cAAAf,iBAAA,uBAAhBA,iBAAA,CAAkBgB,MAAM,KAAI;IAAO,CAAC;IAE7D;IACAC,eAAe,EAAE,IAAI;IACrBC,qBAAqB,EAAE,kBAAkB;IAEzC;IACAC,YAAY,EAAE,IAAI;IAClBC,0BAA0B,EAAE,EAAE;IAE9B;IACAC,UAAU,EAAE,CAAC,YAAY,CAAC;IAE1B;IACAC,SAAS,EAAE,CAACvB,WAAW,CAACuB,SAAS,IAAI,EAAE,EAAEC,GAAG,CAACC,KAAK,KAAK;MACrDC,YAAY,EAAE;QAAEC,OAAO,EAAEF;MAAM,CAAC;MAChCG,IAAI,EAAE;IACR,CAAC,CAAC;EACJ,CAAC;AAAA,CAAC;AAEF,OAAO,MAAMC,gBAAgB,GAAG,MAAO7B,WAAW,IAChD8B,UAAU,CAAC,YAAY,EAAE;EACvBC,MAAM,EAAE,MAAM;EACd3B,IAAI,EAAE4B,IAAI,CAACC,SAAS,CAAClC,YAAY,CAACC,WAAW,CAAC;AAChD,CAAC,CAAC;AAEJ,OAAO,MAAMkC,gBAAgB,GAAG,MAAAA,CAAOC,OAAO,EAAEnC,WAAW,KACzD8B,UAAU,CAAC,cAAcK,OAAO,EAAE,EAAE;EAClCJ,MAAM,EAAE,OAAO;EACf3B,IAAI,EAAE4B,IAAI,CAACC,SAAS,CAAClC,YAAY,CAACC,WAAW,CAAC;AAChD,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}